<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus - Cadastro</title>
    <link rel="stylesheet" href="cadastro.css">
    <script src="cadastro.js" defer></script>

</head>

<script>
    function efetuarLogin() {
        //event.preventDefault(); // Evita o reload da p치gina

        // Obter valores dos campos do formul치rio
        const varnome = document.getElementById("nome").value;
        const email = document.getElementById("email").value;
        const senha = document.getElementById("senha").value;
        const confirmarSenha = document.getElementById("confirmar-senha").value;

        // Valida칞칚o no frontend
        if (senha !== confirmarSenha) {
            alert("As senhas n칚o coincidem!");
            return;
        }

        // DTO que ser치 enviado no corpo da requisi칞칚o
        const UsarioDTO = {  //aqui jun칞칚o do js com java
            nome: varnome,
            email: email,
            senha: senha
        };

        // Configura칞칚o da requisi칞칚o
        fetch("http://localhost:8080/usuarioController/cadastro", {
            method: "POST", // M칠todo HTTP
            headers: {
                "Content-Type": "application/json", // Tipo de conte칰do enviado
            },
            body: JSON.stringify(UsarioDTO), // Converte o DTO para JSON
        })
            .then((response) => {
                if (!response.ok) {
                    throw new Error("Erro ao cadastrar o usu치rio.");
                }
                return response.text(); // Mensagem de sucesso
            })
            .then((data) => {
                alert(data); // Exibe a mensagem retornada pelo backend
                window.location.href = "../home/home.html"; // Redireciona para outra p치gina
            })
            .catch((error) => {
                alert("Erro: " + error.message);
            });
    }

</script>

</head>
<body>
    <div class="register-container">
        <h1>Crie sua conta no Nexus 游뿣</h1>
        <p>Gerencie suas finan칞as com facilidade.</p>

        <form id="cadastroForm" method="POST">
            <label>Nome:</label>
            <input type="text" id="nome" placeholder="Digite seu nome" required>

            <label for="email">Email:</label>
            <input type="email" id="email" placeholder="Digite seu email" required>

            <label for="senha">Senha:</label>
            <input type="password" id="senha" placeholder="Crie uma senha" required>

            <label for="confirmar-senha">Confirmar Senha:</label>
            <input type="password" id="confirmar-senha" placeholder="Confirme sua senha" required>
        </form>

        <button onclick="efetuarLogin()">Cadastrar</button>
        <!--button deve ser fora do form-->

        <!--sumit n칚o funciona no button, 
            deve ser algo do metodo post q precisa de algum parametro, 
            ele parece n칚o encontrar dai ele faz reload na pagina-->

        <p class="login-text">J치 tem uma conta? <a href="../login/login.html">Fa칞a login</a></p>
    </div>
</body>
</html>